# **缩放功能接口文档**

## **接口路径**
- 状态管理接口：`src/core/zoom/ZoomManager.ts`
- 上下文接口：`src/core/zoom/ZoomContext.tsx`
- 组件接口：`src/ui/AppWithZoom.tsx`

## **功能说明**
缩放功能负责管理3D场景的缩放状态，实现UI滑块控制与3D场景渲染的联动。采用关注点分离原则，将状态管理、业务逻辑和UI渲染分离。

## **请求参数**

### ZoomManager 接口
```typescript
interface ZoomState {
  value: number;    // 当前缩放值，范围0-100
  min: number;      // 最小缩放值，默认0
  max: number;      // 最大缩放值，默认100
  step: number;     // 缩放步长，默认1
}

interface ZoomManager {
  getState(): ZoomState;
  setZoom(value: number): void;
  reset(): void;
  isValidZoom(value: number): boolean;
}
```

### ZoomContext 接口
```typescript
interface ZoomContextType {
  zoomState: ZoomState;
  setZoom: (value: number) => void;
  resetZoom: () => void;
  getCameraDistance: () => number;
}
```

## **响应格式**

### 缩放状态响应
```typescript
{
  value: 50,
  min: 0,
  max: 100,
  step: 1
}
```

### 相机距离响应
- 缩放值0对应相机距离10（最远）
- 缩放值50对应相机距离6（中间）
- 缩放值100对应相机距离2（最近）

## **逻辑**

### 缩放值转换逻辑
- **zoomValueToCameraDistance**: 将UI缩放值(0-100)转换为3D场景相机距离(2-10)
- **cameraDistanceToZoomValue**: 将3D场景相机距离转换为UI缩放值

### 状态管理逻辑
- 缩放值范围验证：确保缩放值在[min, max]范围内
- 状态更新：通过React Context触发组件重新渲染
- 相机同步：缩放值变化时自动更新3D场景相机位置

## **响应示例**

### 设置缩放值
```typescript
// 输入：缩放值75
zoomManager.setZoom(75);

// 输出：状态更新为 { value: 75, min: 0, max: 100, step: 1 }
```

### 获取相机距离
```typescript
// 输入：缩放值50
const distance = zoomValueToCameraDistance(50);

// 输出：相机距离6
```

### 无效缩放值处理
```typescript
// 输入：缩放值150
zoomManager.setZoom(150);

// 输出：控制台警告"缩放值150超出有效范围[0, 100]"，状态保持不变
```

## **相关文件**

### 核心文件
- `src/core/zoom/ZoomManager.ts` - 缩放状态管理和业务逻辑
- `src/core/zoom/ZoomContext.tsx` - React上下文和Hook
- `src/ui/AppWithZoom.tsx` - 主应用组件（带缩放功能）
- `src/core/Scene3D.tsx` - 3D场景组件（支持缩放参数）

### 测试文件
- `tests/core/zoom.test.ts` - 缩放功能集成测试

### 配置文件
- `src/main.tsx` - 应用入口（使用AppWithZoom组件）
